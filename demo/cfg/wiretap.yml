version: 1
formatters:
  console:
    style: "{"
    format: "{asctime}.{msecs:03d} | {module}.{funcName} | {message}"
    datefmt: "%Y-%m-%d %H:%M:%S"
    defaults:
      status: "<status>"
      correlation: "<correlation>"
      extra: "<extra>"
  wiretap:
    (): "logging.Formatter"
    style: "{"
    datefmt: "%Y-%m-%d %H:%M:%S"
    "fmt": "{asctime}.{msecs:03.0f} {indent} {activity_name} | {event_name} | {activity_elapsed} | {event_message} | {event_snapshot} | {event_tags}"
  elastic:
    "()": wiretap.formatters.JSONFormatter
    ".":
      json_encoder_cls: wiretap.tools.JSONMultiEncoder
filters:
  timestamp_local:
    (): "wiretap.filters.AddTimestampExtra"
    tz: "local"
  timestamp_utc:
    (): "wiretap.filters.AddTimestampExtra"
    tz: "utc"
  indent:
    (): "wiretap.filters.AddIndentExtra"
    char: "_"
  strip_exc_info:
    (): "wiretap.filters.StripExcInfo"
  instance:
    (): "wiretap.filters.AddConstExtra"
    name: "instance"
    value: "demo-1"
handlers:
  console:
    class: "logging.StreamHandler"
    formatter: "wiretap"
    level: "DEBUG"
    filters:
      - indent
      - timestamp_local
      - strip_exc_info
  file:
    class: "logging.handlers.TimedRotatingFileHandler"
    when: "d"
    interval: 1
    filename: "c:\\temp\\wiretap.log"
    formatter: wiretap
    level: "DEBUG"
    filters:
      - indent
      - timestamp_local
      - strip_exc_info
  elastic_file:
    class: "logging.FileHandler"
    filename: "c:\\temp\\elastic.log"
    formatter: elastic
    level: "DEBUG"
    filters:
      - timestamp_utc
      - strip_exc_info
  #sqlserver:
  #  class: "wiretap_sqlserver.SqlServerHandler"
  #  #connection_string: "DRIVER={ODBC Driver 18 for SQL Server};SERVER=localhost,1433;DATABASE=automation;UID=sa;PWD=;"
  #  insert: null
  #  level: "DEBUG"
  #  formatter: "auto"

loggers:
  root:
    handlers: [ "console", "file", "elastic_file" ]
    #handlers: [ "console", "elastic_file" ]
    #handlers: [ "console" ]
    level: "DEBUG"
  PIL:
    level: "WARNING"